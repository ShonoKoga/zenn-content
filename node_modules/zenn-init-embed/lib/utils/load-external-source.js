"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadStylesheet = exports.loadScript = void 0;
function loadScript(_a) {
    var src = _a.src, id = _a.id, _b = _a.refreshIfExist, refreshIfExist = _b === void 0 ? true : _b;
    var identicalScript = id ? document.getElementById(id) : null;
    if (identicalScript) {
        if (!refreshIfExist)
            return; // refreshIfExist:falseの場合は何もせず終了
        identicalScript.remove(); // 既存の同一scriptは削除しておく
    }
    return new Promise(function (resolve, reject) {
        var script = document.createElement("script");
        script.setAttribute("src", src);
        document.head.appendChild(script);
        script.onload = function () {
            if (id)
                script.setAttribute("id", id);
            resolve();
        };
        script.onerror = function (e) { return reject(e); };
    });
}
exports.loadScript = loadScript;
function loadStylesheet(_a) {
    var href = _a.href, id = _a.id;
    if (document.getElementById(id))
        return; // already loaded
    var link = document.createElement("link");
    link.setAttribute("rel", "stylesheet");
    link.setAttribute("id", id);
    link.setAttribute("href", href);
    document.head.appendChild(link);
}
exports.loadStylesheet = loadStylesheet;
