"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.exec = void 0;
var path_1 = __importDefault(require("path"));
var fs_extra_1 = __importDefault(require("fs-extra"));
var arg_1 = __importDefault(require("arg"));
var slug_helper_1 = require("../utils/slug-helper");
var safe_1 = __importDefault(require("colors/safe"));
var pickRandomEmoji = function () {
    // prettier-ignore
    var emojiList = ["ğŸ˜º", "ğŸ“˜", "ğŸ“š", "ğŸ“‘", "ğŸ˜Š", "ğŸ˜", "ğŸ‘»", "ğŸ¤–", "ğŸ˜¸", "ğŸ˜½", "ğŸ’¨", "ğŸ’¬", "ğŸ’­", "ğŸ‘‹", "ğŸ‘Œ", "ğŸ‘", "ğŸ™Œ", "ğŸ™†", "ğŸ•", "ğŸˆ", "ğŸ¦", "ğŸ·", "ğŸ¦”", "ğŸ¥", "ğŸ¡", "ğŸ™", "ğŸ£", "ğŸ•Œ", "ğŸŒŸ", "ğŸ”¥", "ğŸŒŠ", "ğŸƒ", "âœ¨", "ğŸ‰", "â›³", "ğŸ”–", "ğŸ“", "ğŸ—‚", "ğŸ“Œ"];
    return emojiList[Math.floor(Math.random() * emojiList.length)];
};
exports.exec = function (argv) {
    var args = arg_1.default({
        "--slug": String,
        "--title": String,
        "--type": String,
        "--emoji": String,
        "--published": String,
    }, { argv: argv });
    var slug = args["--slug"] || slug_helper_1.generateSlug();
    if (!slug_helper_1.validateSlug(slug)) {
        var errorMessage = slug_helper_1.getSlugErrorMessage(slug);
        console.error(safe_1.default.red("\u30A8\u30E9\u30FC\uFF1A" + errorMessage));
        process.exit(1);
    }
    var fileName = slug + ".md";
    var filePath = path_1.default.join(process.cwd(), "articles", fileName);
    var title = args["--title"] || "";
    var emoji = args["--emoji"] || pickRandomEmoji();
    var type = args["--type"] === "idea" ? "idea" : "tech";
    var published = args["--published"] === "true" ? "true" : "false"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯false
    var fileBody = [
        "---",
        "title: \"" + title + "\"",
        "emoji: \"" + emoji + "\"",
        "type: \"" + type + "\" # tech: \u6280\u8853\u8A18\u4E8B / idea: \u30A2\u30A4\u30C7\u30A2",
        "topics: []",
        "published: " + published,
        "---",
    ].join("\n") + "\n";
    try {
        fs_extra_1.default.writeFileSync(filePath, fileBody, { flag: "wx" } // Don't overwrite
        );
        console.log("\uD83D\uDCC4" + safe_1.default.green(fileName) + " created.");
    }
    catch (e) {
        console.log(safe_1.default.red("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ") + e);
    }
};
